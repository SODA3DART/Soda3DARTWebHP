document.addEventListener("DOMContentLoaded",function(){initFilterFunctionality();initLightbox();initThumbnailPosition();initHoverImageChange()});function initFilterFunctionality(){const filterButtons=document.querySelectorAll(".filter-button");const galleryItems=document.querySelectorAll(".gallery-item");const gallerySections=document.querySelectorAll(".gallery-section");filterButtons.forEach(button=>{button.addEventListener("click",function(){filterButtons.forEach(btn=>btn.classList.remove("active"));this.classList.add("active");const filterValue=this.getAttribute("data-filter");const sectionVisibility={};galleryItems.forEach(item=>{const itemCategory=item.getAttribute("data-category");const parentSection=item.closest(".gallery-section");if(filterValue==="all"||itemCategory===filterValue){item.style.display="block";if(parentSection){sectionVisibility[parentSection.querySelector(".section-title").textContent]=true}}else{item.style.display="none"}});gallerySections.forEach(section=>{const sectionTitle=section.querySelector(".section-title").textContent;if(filterValue==="all"||sectionVisibility[sectionTitle]){section.style.display="block"}else{section.style.display="none"}})})})}function initLightbox(){const lightbox=document.getElementById("imageLightbox");const lightboxImg=document.getElementById("lightboxImage");const lightboxClose=document.querySelector(".lightbox-close");const lightboxGallery=document.getElementById("lightboxGallery");const lightboxDescription=document.getElementById("lightboxDescription");const galleryImages=document.querySelectorAll(".gallery-image img, .video-container img");const specialArtworks={"ポピー":{images:["images/gallery/Poppy.png","images/gallery/miniPoppy.png","images/gallery/PoppySettnings.png","images/gallery/Poppyw.png"],description:`
                <h3>ポピー - キャラクター設定</h3>
                <p>キャラクターデザインの課題として作成したオリジナルゲームのキャラクター「ポピー」です。</p>
                <p>ポピーは架空のRPGゲームの主人公で、魔法と剣術を使いこなす少女戦士です。</p>
                <p>赤い髪と青い瞳が特徴的で、冒険の中で様々な仲間と出会いながら成長していきます。</p>
                <p>このモデルはFusion 360とBlenderを使用して作成し、ゲームエンジンへの実装も行いました。</p>
            `}};galleryImages.forEach(image=>{image.addEventListener("click",function(){const artworkTitle=getArtworkTitle(this);openLightbox(this.src,artworkTitle)})});if(lightboxClose){lightboxClose.addEventListener("click",function(){closeLightbox()})}if(lightbox){lightbox.addEventListener("click",function(event){if(event.target===lightbox){closeLightbox()}})}document.addEventListener("keydown",function(event){if(event.key==="Escape"&&lightbox&&lightbox.classList.contains("active")){closeLightbox()}});function isSpecialArtwork(title){return specialArtworks.hasOwnProperty(title)}function getArtworkTitle(imageElement){const galleryItem=imageElement.closest(".gallery-item");if(galleryItem){const titleElement=galleryItem.querySelector(".gallery-title");return titleElement?titleElement.textContent:null}return null}function openLightbox(imageSrc,artworkTitle){if(!lightbox||!lightboxImg)return;if(lightboxGallery)lightboxGallery.innerHTML="";if(lightboxDescription)lightboxDescription.innerHTML="";lightboxImg.src=imageSrc;if(artworkTitle&&isSpecialArtwork(artworkTitle)){const artwork=specialArtworks[artworkTitle];if(lightboxGallery){artwork.images.forEach((imgSrc,index)=>{const thumbnail=document.createElement("img");thumbnail.src=imgSrc;thumbnail.alt=`${artworkTitle} - Image ${index+1}`;if(imgSrc===imageSrc){thumbnail.classList.add("active")}thumbnail.addEventListener("click",function(){lightboxImg.src=imgSrc;lightboxGallery.querySelectorAll("img").forEach(img=>{img.classList.remove("active")});thumbnail.classList.add("active")});lightboxGallery.appendChild(thumbnail)})}if(lightboxDescription){lightboxDescription.innerHTML=artwork.description}}void lightbox.offsetWidth;lightbox.classList.add("active");document.body.classList.add("viewing-art")}function closeLightbox(){if(!lightbox)return;lightbox.classList.remove("active");document.body.classList.remove("viewing-art")}}function initThumbnailPosition(){const galleryImages=document.querySelectorAll(".gallery-image img");galleryImages.forEach(image=>{const position=image.getAttribute("data-position");if(position){image.style.objectPosition=position}else{image.style.objectPosition="center 30%"}})}function initHoverImageChange(){const galleryItems=document.querySelectorAll(".gallery-item");const specialArtworks={"ポピー":{images:["images/gallery/Poppy.png","images/gallery/miniPoppy.png","images/gallery/PoppySettnings.png","images/gallery/Poppyw.png"]}};galleryItems.forEach(item=>{const titleElement=item.querySelector(".gallery-title");if(!titleElement)return;const title=titleElement.textContent;if(isSpecialArtwork(title)){const imgElement=item.querySelector(".gallery-image img");if(!imgElement)return;const originalSrc=imgElement.src;const artwork=specialArtworks[title];if(artwork.images.length>1){const hoverSrc=artwork.images[1];item.addEventListener("mouseenter",function(){imgElement.src=hoverSrc});item.addEventListener("mouseleave",function(){imgElement.src=originalSrc})}}});function isSpecialArtwork(title){return specialArtworks.hasOwnProperty(title)}}